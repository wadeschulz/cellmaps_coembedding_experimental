=====
Usage
=====

The 'cellmaps_coembedding' tool takes image and Protein-Protein Interaction (PPI) embeddings and generates co-embedding. The embeddings can be generated by
'cellmaps_image_embedding' and 'cellmaps_ppi_embedding' packages.

In a project
--------------

To use cellmaps_coembedding in a project::

    import cellmaps_coembedding


Needed files
------------

The output directories for the image embeddings (see `Cell Maps Image Embedding <https://github.com/idekerlab/cellmaps_image_embedding/>`__) and protein-protein interaction network embeddings (see `Cell Maps PPI Embedding <https://github.com/idekerlab/cellmaps_ppi_embedding/>`__) are required.


On the command line
---------------------

For information invoke :code:`cellmaps_coembeddingcmd.py -h`

**Usage**

.. code-block::

  cellmaps_coembeddingcmd.py [outdir] [--ppi_embeddingdir PPI_EMBEDDING_DIR] [--image_embeddingdir IMAGE_EMBEDDING_DIR] [OPTIONS]

**Arguments**

- ``outdir``
    The directory where the output will be written to.

*Required*

- ``--ppi_embeddingdir``
    The directory path created by `cellmaps_ppi_embedding` which has a TSV file containing the embeddings of the PPI network. For each row, the first value is assumed to be the gene symbol followed by the embeddings.

- ``--image_embeddingdir``
    The directory path created by `cellmaps_image_embedding` which has a TSV file containing the embeddings of the IF images. For each row, the first value is assumed to be the sample ID followed by the embeddings.

*Optional*

- ``--latent_dimension``
    Output dimension of the embedding. Default is 128.

- ``--n_epochs_init``
    Number of initial training epochs. Default is 200.

- ``--n_epochs``
    Number of training epochs. Default is 500.

- ``--jackknife_percent``
    Percentage of data to withhold from training. For example, a value of 0.1 means to withhold 10 percent of the data.

- ``--fake_embedding``
    If set, generates fake co-embeddings.

- ``--logconf``
    Path to the Python logging configuration file in the specified format.

- ``--verbose`` or ``-v``
    Increases verbosity of the logger to standard error for log messages in this module. Logging levels: `-v` = ERROR, `-vv` = WARNING, `-vvv` = INFO, `-vvvv` = DEBUG, `-vvvvv` = NOTSET.

- ``--version``
    Shows the version of the program.

**Example usage**

.. code-block::

   cellmaps_coembeddingcmd.py ./cellmaps_coembedding_outdir --image_embeddingdir ./cellmaps_image_embedding_outdir --ppi_embeddingdir ./cellmaps_ppi_embedding_outdir

Via Docker
---------------

**Example usage**


.. code-block::

   docker run -v `pwd`:`pwd` -w `pwd` idekerlab/cellmaps_coembedding:0.1.0 cellmaps_coembeddingcmd.py ./cellmaps_coembedding_outdir --image_embeddingdir ./cellmaps_image_embedding_outdir --ppi_embeddingdir ./cellmaps_ppi_embedding_outdir



